{% extends "base.html" %}
{% block title %}History for {{ patient_name }}{% endblock %}
{% block content %}
<h1 class="mb-4">ğŸ“„ History for: {{ patient_name }}</h1>

<a href="{{ url_for('doctor_dashboard') }}" class="btn btn-outline-secondary mb-3">â† Back to Dashboard</a>

{% for appt in history %}
<div class="card mb-3 shadow-sm">
    <div class="card-header bg-info text-white">
        <h5>Visit Date: {{ appt.date }} at {{ appt.time }}</h5>
        <p class="m-0">Consulted Doctor: Dr. {{ appt.doctor.user.name }}</p>
    </div>
    <div class="card-body">
        {% if appt.record %}
            <div class="row">
                <div class="col-md-6">
                    <h6>ğŸ©º Diagnosis:</h6>
                    <p>{{ appt.record.diagnosis | default("N/A", true) }}</p>
                </div>
                <div class="col-md-6">
                    <h6>ğŸ’Š Prescription:</h6>
                    <p class="border p-2 bg-light">{{ appt.record.prescription | default("No prescription recorded.", true) }}</p>
                </div>
            </div>
            <h6>ğŸ“ Doctor's Notes:</h6>
            <p class="text-gray-700 leading-relaxed whitespace-pre-wrap">{{ appt.record.notes | default("No additional notes.", true) }}</p>
        {% else %}
            <p class="text-warning">Treatment record not found for this completed appointment.</p>
        {% endif %}
    </div>
</div>
{% else %}
<div class="alert alert-info">No completed appointment history found for this patient.</div>
{% endfor %}
{% endblock %}
